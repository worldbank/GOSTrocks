{"version":3,"kind":"Notebook","sha256":"7a65eb036b470ac1e499961b2048f4e623d5399ca00fe115bf2e8dce8e685078","slug":"examples.gostrocks-usage","location":"/examples/GOSTrocks_Usage.ipynb","dependencies":[],"frontmatter":{"title":"GOSTrocks Primer","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"gostrocks","language":"python"},"github":"https://github.com/worldbank/GOSTrocks","numbering":{"title":{"offset":1}},"source_url":"https://github.com/worldbank/GOSTrocks/blob/main/docs/examples/GOSTrocks_Usage.ipynb","edit_url":"https://github.com/worldbank/GOSTrocks/edit/main/docs/examples/GOSTrocks_Usage.ipynb","thumbnail":"GOSTrocks/build/7e2db436150c38a00650f96925aa5581.svg","exports":[{"format":"ipynb","filename":"GOSTrocks_Usage.ipynb","url":"GOSTrocks/build/GOSTrocks_Usage-7ee9567ca30ae476cf3c4c6affa4527e.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"GOSTrocks is an internal sandbox repository that contains commonly used geospatial functions and operations. This notebooks demonstrates the usage of selected functions.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VBIZdfOlY0"}],"key":"lvBLORJgmN"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The repository also contains customized code to process specific datasets (GHSL, OpenStreetMap, Nighttime Lights, Fathom). This code is in constant development as project requirements evolve over time.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"urRLTkvISj"}],"key":"W5nzBODzjO"}],"key":"FzMO9p1MMa"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"link","url":"https://colab.research.google.com/github/worldbank/GOSTrocks/blob/glevin_review/docs/examples/GOSTrocks_Usage.ipynb","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"image","url":"GOSTrocks/build/7e2db436150c38a00650f96925aa5581.svg","alt":"Open in Colab","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nsQH9DbfmV","urlSource":"https://colab.research.google.com/assets/colab-badge.svg"}],"urlSource":"https://colab.research.google.com/github/worldbank/GOSTrocks/blob/glevin_review/docs/examples/GOSTrocks_Usage.ipynb","key":"mtklelTBNM"}],"key":"rfmIzq2nTM"}],"key":"IiGRZa89Y4"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Installation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"La3hnm3LND"}],"identifier":"installation","label":"Installation","html_id":"installation","implicit":true,"key":"jvemLBQLCf"}],"key":"Cg22jtihS3"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"From PyPI","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QBSzpDDT05"}],"identifier":"from-pypi","label":"From PyPI","html_id":"from-pypi","implicit":true,"key":"zVWK3xzGmK"}],"key":"aEVAEDeNzY"},{"type":"block","kind":"notebook-content","children":[{"type":"code","lang":"","value":"pip install GOSTrocks","position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"key":"qNUtyfuFSt"}],"key":"TVujxjUDh2"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"From Source","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DMgLfXwYFV"}],"identifier":"from-source","label":"From Source","html_id":"from-source","implicit":true,"key":"asmiSxsiwr"}],"key":"lyQgWJy4nx"},{"type":"block","kind":"notebook-content","children":[{"type":"code","lang":"","value":"git clone https://github.com/worldbank/GOSTrocks.git\ncd GOSTrocks\npip install .","position":{"start":{"line":1,"column":1},"end":{"line":5,"column":1}},"key":"C1UyIR45gt"}],"key":"UkQLmDWOJc"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Import Functions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rncHV6iwdG"}],"identifier":"import-functions","label":"Import Functions","html_id":"import-functions","implicit":true,"key":"y8t1WK2S1f"}],"key":"gusu2XNKQ4"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"GOSTrocks is broken down into modules of functions that share common elements.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uGrk9LSy6A"}],"key":"YaYi1O20v7"}],"key":"pMbj8Y4SoC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import GOSTrocks.dataMisc as dMisc  # search and download specific datasets\nimport GOSTrocks.rasterMisc as rMisc  # Raster tools!","key":"RUGnIHFEZH"},{"type":"outputs","id":"Jl70V6W0cBgZc6z7hpmoV","children":[],"key":"VremYvDFt6"}],"key":"OLzO4lZodc"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Raster Example","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UjBSsMflaV"}],"identifier":"raster-example","label":"Raster Example","html_id":"raster-example","implicit":true,"key":"s4g8jFLKXO"}],"key":"QL5L8Cpdcq"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"One of the most recurring workflows is to clip and combine raster data from different sources.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nMw3nf0gQh"}],"key":"EH1TuBLebP"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here, we work with population data from WorldPop, and a friction surface from the Malaria Atlas Project, using Ghana as our area of interest.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YdgmwPE0Ob"}],"key":"w9bmG43LSo"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"They are both global datasets with ~1km resolution, so they both need to be clipped and standardized for analysis.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Z6kFDh4IVu"}],"key":"WIdywGHLrz"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"We will use administrative boundaries from the GeoBoundaries API.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"gn2QpamndG"}],"key":"D36akT5OXg"}],"key":"wTT3TjAvE5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import os\nfrom os.path import join, exists\nimport urllib.request\n\nimport rasterio as rio\nfrom rasterio.plot import show\n\nimport matplotlib.pyplot as plt\nimport matplotlib.colors as colors","key":"FTf9AUg9NV"},{"type":"outputs","id":"iZxZzD7Dr-eplS8Gb3zv4","children":[],"key":"n27gsYT3Qn"}],"key":"Dp4jtJstLq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"country = \"Ghana\"\niso = \"GHA\"","key":"tYG2uTy2Fd"},{"type":"outputs","id":"S1ot55IkMqHqa5baIhjfI","children":[],"key":"A66B16d1Db"}],"key":"croY5HFqFR"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Get Boundaries","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"L8bbgwG7tU"}],"identifier":"get-boundaries","label":"Get Boundaries","html_id":"get-boundaries","implicit":true,"key":"Jpa0jKUlIw"}],"key":"tCdvTlBhKR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dMisc.get_geoboundaries?","key":"VU9TTZ3Ft9"},{"type":"outputs","id":"A_dpEWhfA9LsCVvkyZVmy","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"\u001b[0;31mSignature:\u001b[0m\n\u001b[0mdMisc\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_geoboundaries\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m    \u001b[0miso3\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m    \u001b[0mlevel\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m    \u001b[0mgeo_api\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m'https://www.geoboundaries.org/api/current/gbOpen/{iso3}/{adm}/'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;31mDocstring:\u001b[0m\nDownload boundaries dataset from geobounadries\n\nParameters\n----------\niso3 : bool\n    ISO3 code of country to download\nlevel : str\n    Admin code to download in format of \"ADM1\" or \"ADM2\"\ngeo_api : str, optional\n    by default \"https://www.geoboundaries.org/api/current/gbOpen/{iso3}/{adm}/\"\n\nReturns\n-------\ngpd.GeoDataFrame\n    spatial data representing the administrative boundaries\n\u001b[0;31mFile:\u001b[0m      ~/Documents/WorldBank/GOSTrocks/src/GOSTrocks/dataMisc.py\n\u001b[0;31mType:\u001b[0m      function"},"children":[],"key":"G69QeQts05"}],"key":"QatZKSLIBe"}],"key":"idf7d5GJAA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"gdf = dMisc.get_geoboundaries(iso, level=\"ADM0\")\ngdf.plot()","key":"u7zHtK4Y4j"},{"type":"outputs","id":"-v_yxefdSuUbGbbdsW-Ga","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"<Axes: >","content_type":"text/plain"}}},"children":[],"key":"w6dlvOptR6"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6eb87cdc77bcb9310180dcc102e8b595","path":"GOSTrocks/build/6eb87cdc77bcb9310180dcc102e8b595.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"ljIehOt4EY"}],"key":"JsppmND3oM"}],"key":"NLsM6aTEiF"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Download Population Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mBijC6qjK4"}],"identifier":"download-population-data","label":"Download Population Data","html_id":"download-population-data","implicit":true,"key":"OZMlL0OUTT"}],"key":"LOfdV2kKxW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"wp_url = f\"https://data.worldpop.org/GIS/Population/Global_2000_2020_1km/2020/{iso.upper()}/{iso.lower()}_ppp_2020_1km_Aggregated.tif\"\nwp_url","key":"JeUdRJdXx1"},{"type":"outputs","id":"FTRHyVNZesmYx97zBmJIf","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"'https://data.worldpop.org/GIS/Population/Global_2000_2020_1km/2020/GHA/gha_ppp_2020_1km_Aggregated.tif'","content_type":"text/plain"}}},"children":[],"key":"RhMzpjGzC6"}],"key":"ZlEQOAVmos"}],"key":"hdjLuJEebz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"wp_path = join(\n    \"..\", \"data\", f\"{iso}_ppp_2020_1km_Aggregated_UNadj.tif\"\n)  # Download from link above\nif not exists(wp_path):\n    urllib.request.urlretrieve(wp_url, wp_path)","key":"mPR4TAvkmF"},{"type":"outputs","id":"ZcruIL9SbbvKuNo7niTnp","children":[],"key":"uJLos1duV3"}],"key":"Re3G9BdK14"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"src_pop = rio.open(wp_path)","key":"C6xkYRqol7"},{"type":"outputs","id":"LiRgz3RAjwMyD8ITd5SWX","children":[],"key":"uxUmmKt5T5"}],"key":"Iy2HNW151b"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(1, 1, figsize=(8, 8))\nshow(src_pop, norm=colors.PowerNorm(gamma=0.5), cmap=\"viridis\", ax=ax)\nplt.axis(\"off\")","key":"JJYhkrIjYL"},{"type":"outputs","id":"SLFBx7oSe1MMDWk4Ut-TN","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"(np.float64(-3.251249987361092),\n np.float64(1.190416661538908),\n np.float64(4.732916852582885),\n np.float64(11.174583493482885))","content_type":"text/plain"}}},"children":[],"key":"tK98FNIVb4"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d2c03c81f1e4fa13de08162a37813e6b","path":"GOSTrocks/build/d2c03c81f1e4fa13de08162a37813e6b.png"},"text/plain":{"content":"<Figure size 800x800 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"FHkpzxVmmX"}],"key":"lJnHe0wNYI"}],"key":"yLYvGzwhr3"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Clip Global Friction Surface","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"E2l9esj2Zp"}],"identifier":"clip-global-friction-surface","label":"Clip Global Friction Surface","html_id":"clip-global-friction-surface","implicit":true,"key":"HHlmGzpPnF"}],"key":"K2AWhGtcHI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"gfs_path = \"/Users/glevin/Documents/WorldBank/GOSTrocks/2020_motorized_friction_surface.geotiff\"\nsrc_travel = rio.open(gfs_path)","key":"TAxmj8SLeo"},{"type":"outputs","id":"fyHogcNt5H4_LWAFdmfZd","children":[],"key":"wGWjpzMkEo"}],"key":"Vc01xT9YMx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# fig, ax = plt.subplots(1, 1, figsize=(8, 8))\n# show(src_travel, norm=colors.PowerNorm(gamma=0.2), cmap=\"magma\", ax=ax)\n# plt.axis(\"off\")","key":"YgmQd676z5"},{"type":"outputs","id":"UFaVCK2cAGbRtYBK8eTDj","children":[{"type":"output","jupyter_data":{"ename":"KeyboardInterrupt","evalue":"","output_type":"error","traceback":"\u001b[0;31m---------------------------------------------------------------------------\u001b[0m\n\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)\nCell \u001b[0;32mIn[12], line 2\u001b[0m\n\u001b[1;32m      1\u001b[0m fig, ax \u001b[38;5;241m=\u001b[39m plt\u001b[38;5;241m.\u001b[39msubplots(\u001b[38;5;241m1\u001b[39m, \u001b[38;5;241m1\u001b[39m, figsize\u001b[38;5;241m=\u001b[39m(\u001b[38;5;241m8\u001b[39m, \u001b[38;5;241m8\u001b[39m))\n\u001b[0;32m----> 2\u001b[0m \u001b[43mshow\u001b[49m\u001b[43m(\u001b[49m\u001b[43msrc_travel\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mnorm\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mcolors\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mPowerNorm\u001b[49m\u001b[43m(\u001b[49m\u001b[43mgamma\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;241;43m0.2\u001b[39;49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mcmap\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mmagma\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43max\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43max\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m      3\u001b[0m plt\u001b[38;5;241m.\u001b[39maxis(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124moff\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\nFile \u001b[0;32m/opt/homebrew/Caskroom/miniconda/base/envs/gostrocks/lib/python3.10/site-packages/rasterio/plot.py:90\u001b[0m, in \u001b[0;36mshow\u001b[0;34m(source, with_bounds, contour, contour_label_kws, ax, title, transform, adjust, **kwargs)\u001b[0m\n\u001b[1;32m     87\u001b[0m     kwargs[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mextent\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m plotting_extent(source)\n\u001b[1;32m     89\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m source\u001b[38;5;241m.\u001b[39mcount \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[0;32m---> 90\u001b[0m     arr \u001b[38;5;241m=\u001b[39m \u001b[43msource\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mread\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;241;43m1\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mmasked\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;28;43;01mTrue\u001b[39;49;00m\u001b[43m)\u001b[49m\n\u001b[1;32m     91\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m     92\u001b[0m     \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m     93\u001b[0m         \u001b[38;5;66;03m# Lookup table for the color space in the source file.\u001b[39;00m\n\u001b[1;32m     94\u001b[0m         \u001b[38;5;66;03m# This will allow us to re-order it to RGB if needed\u001b[39;00m\n\nFile \u001b[0;32mrasterio/_io.pyx:651\u001b[0m, in \u001b[0;36mrasterio._io.DatasetReaderBase.read\u001b[0;34m()\u001b[0m\n\nFile \u001b[0;32mrasterio/_io.pyx:966\u001b[0m, in \u001b[0;36mrasterio._io.DatasetReaderBase._read\u001b[0;34m()\u001b[0m\n\nFile \u001b[0;32mrasterio/_io.pyx:271\u001b[0m, in \u001b[0;36mrasterio._io.io_multi_mask\u001b[0;34m()\u001b[0m\n\nFile \u001b[0;32m/opt/homebrew/Caskroom/miniconda/base/envs/gostrocks/lib/python3.10/contextlib.py:139\u001b[0m, in \u001b[0;36m_GeneratorContextManager.__exit__\u001b[0;34m(self, typ, value, traceback)\u001b[0m\n\u001b[1;32m    136\u001b[0m     \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mStopIteration\u001b[39;00m:\n\u001b[1;32m    137\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mRuntimeError\u001b[39;00m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mgenerator didn\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mt yield\u001b[39m\u001b[38;5;124m\"\u001b[39m) \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mNone\u001b[39;00m\n\u001b[0;32m--> 139\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21m__exit__\u001b[39m(\u001b[38;5;28mself\u001b[39m, typ, value, traceback):\n\u001b[1;32m    140\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m typ \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m    141\u001b[0m         \u001b[38;5;28;01mtry\u001b[39;00m:\n\n\u001b[0;31mKeyboardInterrupt\u001b[0m: "},"children":[],"key":"RilsUbAtsg"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ab5f1c4612f469f4be57a2f3bfaba849","path":"GOSTrocks/build/ab5f1c4612f469f4be57a2f3bfaba849.png"},"text/plain":{"content":"<Figure size 800x800 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"HAtnMhxLBO"}],"key":"hPyT3N74V4"}],"key":"IPSjFQYnMR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"rMisc.clipRaster?","key":"yPy1O28KA2"},{"type":"outputs","id":"B35o8CeeYw8wDYL8khaFq","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"\u001b[0;31mSignature:\u001b[0m \u001b[0mrMisc\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mclipRaster\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0minR\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0minD\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0moutFile\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcrop\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;31mDocstring:\u001b[0m\nClip input raster to provided geodataframe\n\nParameters\n----------\ninR : rasterio.DatasetReader\n    Input raster to clip\ninD : geopandas.GeoDataFrame\n    GeoDataFrame containing the clipping geometry\noutFile : str, optional\n    File to write the clipped raster to, by default None\ncrop : bool, optional\n    Whether to crop the raster to the unary_union of the GeoDataFrame (True) or to the bounding box (False), by default True\n\nReturns\n-------\ntuple\n    A tuple containing the clipped raster and its metadata.\n\u001b[0;31mFile:\u001b[0m      ~/Documents/WorldBank/GOSTrocks/src/GOSTrocks/rasterMisc.py\n\u001b[0;31mType:\u001b[0m      function"},"children":[],"key":"ghcb33f4zS"}],"key":"s0318ml5LR"}],"key":"SJR7Htsjoa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"out_travel = join(\"..\", \"data\", f\"{iso.upper()}_2020_motorized_friction_surface.tif\")\nsurface, surface_meta = rMisc.clipRaster(\n    src_travel, gdf, outFile=out_travel, crop=False\n)","key":"R8BbfH62pw"},{"type":"outputs","id":"B_E_QJYcTzT_ai2nuOqwV","children":[],"key":"VOl4zxpNB5"}],"key":"iKtWFueVDk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(1, 1, figsize=(8, 8))\nshow(surface, norm=colors.PowerNorm(gamma=0.2), cmap=\"magma\", ax=ax)\nplt.axis(\"off\")","key":"JxdqVKFX2b"},{"type":"outputs","id":"S5_8b3vOeoCsing2H3vH_","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/plain":{"content":"(np.float64(-0.5), np.float64(534.5), np.float64(772.5), np.float64(-0.5))","content_type":"text/plain"}}},"children":[],"key":"WXEcMFPLuC"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e7487c18cf067cd965bfe5ef5215b4a6","path":"GOSTrocks/build/e7487c18cf067cd965bfe5ef5215b4a6.png"},"text/plain":{"content":"<Figure size 800x800 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"ts9g3pNUT6"}],"key":"UQTr594oah"}],"key":"zvWB1eWcMs"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Standardize Rasters","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IG73hfUtwZ"}],"identifier":"standardize-rasters","label":"Standardize Rasters","html_id":"standardize-rasters","implicit":true,"key":"d3FIjXSPhs"}],"key":"Zszm85psPG"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Align the population raster to the friction surface, ensuring that they have the same extent and resolution.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Wm11lKksaG"}],"key":"VUJo7dns1g"}],"key":"ZIc3nVYDkn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"rMisc.standardizeInputRasters?","key":"JgWuwnVGDI"},{"type":"outputs","id":"r-qudHMQO-Dga_Qv73tTj","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"\u001b[0;31mSignature:\u001b[0m\n\u001b[0mrMisc\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstandardizeInputRasters\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m    \u001b[0minR1\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m    \u001b[0minR2\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m    \u001b[0minR1_outFile\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m''\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m    \u001b[0mresampling_type\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m'nearest'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\n\u001b[0;34m\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;31mDocstring:\u001b[0m\nStandardize inR1 to inR2: changes crs, extent, and resolution.\n\n:param inR1: rasterio object for raster to be modified\n:type inR1: rasterio.DatasetReader\n:param inR2: rasterio object to be standardized to\n:type inR12 rasterio.DatasetReader\n:param inR1_outfile: path to create output raster file of standardized inR1, default is '', which means nothing is written\n:type inR1: string\n:param resampling_type: how to perform spatial resampling; options are nearest (default), cubic, or sum\n:type resampling_type: string\n:return: array of numpy array, and rasterio metadata\n:rtype: array\n\u001b[0;31mFile:\u001b[0m      ~/Documents/WorldBank/GOSTrocks/src/GOSTrocks/rasterMisc.py\n\u001b[0;31mType:\u001b[0m      function"},"children":[],"key":"Zr7PBxPAdH"}],"key":"afZIZ5b70p"}],"key":"SomJdJ5MIB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"src_travel_clipped = rio.open(out_travel)","key":"s5xOdeNcS6"},{"type":"outputs","id":"qmFQv02KAu6ecPTDMlqzN","children":[],"key":"GmL49l3ZSp"}],"key":"sYGOwVCZMn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"pop_std, pop_meta = rMisc.standardizeInputRasters(\n    src_pop, src_travel_clipped, resampling_type=\"nearest\"\n)","key":"cwKHDmuNwW"},{"type":"outputs","id":"Nh-OlXYDalO5akyfOo7t9","children":[],"key":"FdkqkGyvZO"}],"key":"OMbSU7nghN"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Original population raster metadata:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"z3YXgyVhjz"}],"key":"QqPDyVAwLf"}],"key":"ofoXpyGtGq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"src_pop.meta","key":"jeLNs2SP1p"},{"type":"outputs","id":"gDupmHhL4-2V4dx4RYVL0","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/plain":{"content":"{'driver': 'GTiff',\n 'dtype': 'float32',\n 'nodata': -99999.0,\n 'width': 533,\n 'height': 773,\n 'count': 1,\n 'crs': CRS.from_wkt('GEOGCS[\"WGS 84\",DATUM[\"WGS_1984\",SPHEROID[\"WGS 84\",6378137,298.257223563,AUTHORITY[\"EPSG\",\"7030\"]],AUTHORITY[\"EPSG\",\"6326\"]],PRIMEM[\"Greenwich\",0,AUTHORITY[\"EPSG\",\"8901\"]],UNIT[\"degree\",0.0174532925199433,AUTHORITY[\"EPSG\",\"9122\"]],AXIS[\"Latitude\",NORTH],AXIS[\"Longitude\",EAST],AUTHORITY[\"EPSG\",\"4326\"]]'),\n 'transform': Affine(0.0083333333, 0.0, -3.251249987361092,\n        0.0, -0.0083333333, 11.174583493482885)}","content_type":"text/plain"}}},"children":[],"key":"jE698qg6tP"}],"key":"OQWQRJvPiy"}],"key":"jHhVwZEjsW"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"New population metadata aligned with travel surface:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZuqcplmmPO"}],"key":"wdTeGgun9O"}],"key":"VNXcJdLtHP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"pop_meta, surface_meta","key":"eGrnYZtLMP"},{"type":"outputs","id":"Zi8PwoHNgzBlBMXvnHsi2","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/plain":{"content":"({'driver': 'GTiff',\n  'dtype': 'float32',\n  'nodata': -99999.0,\n  'width': 535,\n  'height': 773,\n  'count': 1,\n  'crs': CRS.from_wkt('GEOGCS[\"WGS 84\",DATUM[\"WGS_1984\",SPHEROID[\"WGS 84\",6378137,298.257223563,AUTHORITY[\"EPSG\",\"7030\"]],AUTHORITY[\"EPSG\",\"6326\"]],PRIMEM[\"Greenwich\",0,AUTHORITY[\"EPSG\",\"8901\"]],UNIT[\"degree\",0.0174532925199433,AUTHORITY[\"EPSG\",\"9122\"]],AXIS[\"Latitude\",NORTH],AXIS[\"Longitude\",EAST],AUTHORITY[\"EPSG\",\"4326\"]]'),\n  'transform': Affine(0.008333333333333333, 0.0, -3.2583333333333258,\n         0.0, -0.008333333333333333, 11.174999999999997)},\n {'driver': 'GTiff',\n  'dtype': 'float32',\n  'nodata': -9999.0,\n  'width': 535,\n  'height': 773,\n  'count': 1,\n  'crs': CRS.from_wkt('GEOGCS[\"WGS 84\",DATUM[\"WGS_1984\",SPHEROID[\"WGS 84\",6378137,298.257223563,AUTHORITY[\"EPSG\",\"7030\"]],AUTHORITY[\"EPSG\",\"6326\"]],PRIMEM[\"Greenwich\",0,AUTHORITY[\"EPSG\",\"8901\"]],UNIT[\"degree\",0.0174532925199433,AUTHORITY[\"EPSG\",\"9122\"]],AXIS[\"Latitude\",NORTH],AXIS[\"Longitude\",EAST],AUTHORITY[\"EPSG\",\"4326\"]]'),\n  'transform': Affine(0.008333333333333333, 0.0, -3.2583333333333258,\n         0.0, -0.008333333333333333, 11.174999999999997)})","content_type":"text/plain"}}},"children":[],"key":"TRNZD6T0qD"}],"key":"ZNijVyndx3"}],"key":"R8gu75prxy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"src_pop.close()\nsrc_travel.close()\nsrc_travel_clipped.close()","key":"cOhPD2TZO8"},{"type":"outputs","id":"vwQfZdtY5wa9TGDuR3yb1","children":[],"key":"waUDh2mJAj"}],"key":"b1XTlh8vea"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"os.remove(out_travel)\nos.remove(wp_path)","key":"UkVEsXAbPc"},{"type":"outputs","id":"VSp907DbrTB4OzXlsADh3","children":[],"key":"KYReU19L0Z"}],"key":"cJYFlpeQvf"}],"key":"Jkho9jOzGL"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"shapeMisc","url":"/api/shapemisc","group":"Function Reference"},"next":{"title":"Contributing","url":"/contributing","group":"Examples"}}},"domain":"http://localhost:3000"}